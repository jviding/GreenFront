"use strict";angular.module("greenFrontApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","chart.js","firebase"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/air",{templateUrl:"views/air.html",controller:"AirCtrl"}).when("/light",{templateUrl:"views/light.html",controller:"LightCtrl"}).when("/noice",{templateUrl:"views/noice.html",controller:"NoiceCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("greenFrontApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("greenFrontApp").controller("AirCtrl",["$scope","$timeout",function(a,b){function c(a,c,d){K=null!==c?M.orderByChild("timestamp").startAt(a).limit(c):M.orderByChild("timestamp").startAt(a),K.on("value",function(a){b(function(){D(),d(a)})})}function d(a,c,d){L=null!==c?N.orderByChild("timestamp").startAt(a).limit(c):N.orderByChild("timestamp").startAt(a),L.on("value",function(a){b(function(){E(),d(a)})})}function e(a){var b=[],c=[],d=[];a.forEach(function(a){c.push(a.val().min),d.push(a.val().max),b.push(a.val().average),o(a)}),F(b,c,d)}function f(a){var b=[],c=[],d=[];a.forEach(function(a){var e=y(a);e.count>0&&(b.push(e.average),d.push(e.max),c.push(e.min),m(a[0]))}),F(b,c,d)}function g(a){var b=[],c=[],d=[];a.forEach(function(a){var e=y(a);e.count>0&&(b.push(e.average),d.push(e.max),c.push(e.min),n(a[0]))}),F(b,c,d)}function h(a){var b=[],c=[],d=[];a.forEach(function(a){a.forEach(function(a){var e=y(a);e.count>0&&(b.push(e.average),d.push(e.max),c.push(e.min),p(a[0]))})}),F(b,c,d)}function i(a){var b=[];a.forEach(function(a){b.push(a.val().humidity),s(a)}),G(b,null,null)}function j(a){var b=[],c=[],d=[];a.forEach(function(a){var e=z(a);e.count>0&&(b.push(e.average),d.push(e.max),c.push(e.min),q(a[0]))}),G(b,c,d)}function k(a){var b=[],c=[],d=[];a.forEach(function(a){var e=z(a);e.count>0&&(b.push(e.average),d.push(e.max),c.push(e.min),r(a[0]))}),G(b,c,d)}function l(a){var b=[],c=[],d=[];a.forEach(function(a){a.forEach(function(a){var e=z(a);e.count>0&&(console.log(e),b.push(e.average),d.push(e.max),c.push(e.min),t(a[0]))})}),G(b,c,d)}function m(b){var c=new Date(b.val().timestamp);a.templabels.push(H(c.getDate())+"."+H(c.getMonth())+".")}function n(b){var c=new Date(b.val().timestamp);a.templabels.push(H(c.getHours())+":00")}function o(b){var c=new Date(b.val().timestamp);a.templabels.push(H(c.getHours())+":"+H(c.getMinutes()))}function p(b){var c="",d=new Date(b.val().timestamp).getDay();c=0===d?"Sun. ":1===d?"Mon. ":2===d?"Tue. ":3===d?"Wed. ":4===d?"Thu. ":5===d?"Fri. ":"Sat. ",new Date(b.val().timestamp).getHours()<6?a.templabels.push(c+"3am"):new Date(b.val().timestamp).getHours()>=6&&new Date(b.val().timestamp).getHours()<12?a.templabels.push(c+"9am"):new Date(b.val().timestamp).getHours()>=12&&new Date(b.val().timestamp).getHours()<18?a.templabels.push(c+"3pm"):a.templabels.push(c+"9pm")}function q(b){var c=new Date(b.val().timestamp);a.humidlabels.push(H(c.getDate())+"."+H(c.getMonth())+".")}function r(b){var c=new Date(b.val().timestamp);a.humidlabels.push(H(c.getHours())+":00")}function s(b){var c=new Date(b.val().timestamp);a.humidlabels.push(H(c.getHours())+":"+H(c.getMinutes()))}function t(b){var c="",d=new Date(b.val().timestamp).getDay();c=0===d?"Sun. ":1===d?"Mon. ":2===d?"Tue. ":3===d?"Wed. ":4===d?"Thu. ":5===d?"Fri. ":"Sat. ",new Date(b.val().timestamp).getHours()<6?a.humidlabels.push(c+"3am"):new Date(b.val().timestamp).getHours()>=6&&new Date(b.val().timestamp).getHours()<12?a.humidlabels.push(c+"9am"):new Date(b.val().timestamp).getHours()>=12&&new Date(b.val().timestamp).getHours()<18?a.humidlabels.push(c+"3pm"):a.humidlabels.push(c+"9pm")}function u(){var a=new Date,b=25056e5;return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()-b}function v(){var a=new Date,b=5184e5;return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()-b}function w(){var a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()}function x(){var a=(new Date,36e5);return(new Date).getTime()-a}function y(a){var b=0,c=0,d=null,e=null;a.forEach(function(a){b+=parseFloat(a.val().average),(null===e||e<parseFloat(a.val().max))&&(e=parseFloat(a.val().max)),(null===d||d<parseFloat(a.val().min))&&(d=parseFloat(a.val().min)),c++});var f={average:(b/c).toFixed(2),max:e,min:d,count:c};return f}function z(a){var b=0,c=0,d=null,e=null;a.forEach(function(a){b+=parseFloat(a.val().humidity),(null===e||e<parseFloat(a.val().humidity))&&(e=parseFloat(a.val().humidity)),(null===d||d<parseFloat(a.val().humidity))&&(d=parseFloat(a.val().humidity)),c++});var f={average:(b/c).toFixed(2),max:e,min:d,count:c};return f}function A(a){for(var b=[],c=0;24>c;c++)b[c]=[];return a.forEach(function(a){b[new Date(a.val().timestamp).getHours()].push(a)}),b}function B(a){for(var b=[],c=0;30>c;c++)b[c]=[];var d=null,e=0;return a.forEach(function(a){null===d&&(d=new Date(a.val().timestamp).getDate()),d!==new Date(a.val().timestamp).getDate()&&(d=new Date(a.val().timestamp).getDate(),e++),b[e].push(a)}),b}function C(a){for(var b=[],c=0;7>c;c++){b[c]=[];for(var d=0;4>d;d++)b[c][d]=[]}var e=null,f=0;return a.forEach(function(a){null===e&&(e=new Date(a.val().timestamp).getDate()),e!==new Date(a.val().timestamp).getDate()&&(e=new Date(a.val().timestamp).getDate(),f++),new Date(a.val().timestamp).getHours()>=0&&new Date(a.val().timestamp).getHours()<6?b[f][0].push(a):new Date(a.val().timestamp).getHours()>=6&&new Date(a.val().timestamp).getHours()<12?b[f][1].push(a):new Date(a.val().timestamp).getHours()>=12&&new Date(a.val().timestamp).getHours()<18?b[f][2].push(a):b[f][3].push(a)}),b}function D(){a.tempdata=[],a.templabels=[]}function E(){a.humiddata=[],a.humidlabels=[]}function F(b,c,d){a.tempdata.push(b),a.tempdata.push(c),a.tempdata.push(d)}function G(b,c,d){null===c&&null===d?(a.humidseries=["Humidity (%)"],a.humiddata.push(b)):(a.humidseries=["Average (%)","Min (%)","Max (%)"],a.humiddata.push(b),a.humiddata.push(c),a.humiddata.push(d))}function H(a){return 10>a?"0"+a:a}function I(b){1===b?(a.tempAvgExpl="is calculated from the outputs of the 5 second loops over 5 minutes of time. For example 04:43 represents the time between 04:38:00 and 04:42:59.",a.tempMinMaxExpl="is the lowest/highest single output received from the 5 second loops over the 5 minutes of time."):2===b?(a.tempAvgExpl="is calculated from the outputs of the 5 second loops over 1 hour of time. For example 04:00 represents the time between 04:00 and 04:59.",a.tempMinMaxExpl="is the lowest/highest single output received from the 5 second loops over the 1 hour of time."):3===b?(a.tempAvgExpl="is calculated from the outputs of the 5 second loops over 6 hours of time. For example 3am represents the time between 00:00 and 06:00.",a.tempMinMaxExpl="is the lowest/highest single output received from the 5 second loops over the 6 hours of time."):4===b&&(a.tempAvgExpl="is calculated from the outputs of the 5 second loops over 1 day of time. For example 01.05. represents the time between 00:00 and 23:59 that same day.",a.tempMinMaxExpl="is the lowest/highest single output received from the 5 second loops over the 1 day of time.")}function J(b){1===b?(a.visible=!1,a.humidAvgExpl="",a.humidMinMaxExpl=""):2===b?(a.visible=!0,a.humidAvgExpl="is calculated from the outputs of the 5 minute loops over 1 hour of time. For example 04:00 represents the time between 04:00 and 04:59.",a.humidMinMaxExpl="is the lowest/highest single output received from the 5 minute loops over the 1 hour of time."):3===b?(a.visible=!0,a.humidAvgExpl="is calculated from the outputs of the 5 minute loops over 6 hours of time. For example 3am represents the time between 00:00 and 06:00.",a.humidMinMaxExpl="is the lowest/highest single output received from the 5 minute loops over the 6 hours of time."):4===b&&(a.visible=!0,a.humidAvgExpl="is calculated from the outputs of the 5 minute loops over 1 day of time. For example 01.05. represents the time between 00:00 and 23:59 that same day.",a.humidMinMaxExpl="is the lowest/highest single output received from the 5 minute loops over the 1 day of time.")}var K,L,M=new Firebase("https://radiant-heat-5119.firebaseio.com/temperatures"),N=new Firebase("https://radiant-heat-5119.firebaseio.com/humidities");a.items=["1 hour","1 day","1 week","1 month"],a.tempview="1 hour",a.humidview="1 hour",a.templabels=[],a.tempseries=["Average (℃)","Min (℃)","Max (℃)"],a.tempdata=[],a.humidlabels=[],a.humidseries=["Average (%)","Min (%)","Max (%)"],a.humiddata=[],I(1),c(x(),30,function(a){e(a)}),J(1),d(x(),30,function(a){i(a)}),a.onTempClick=function(b){a.view!==b&&(a.tempview=b,"1 hour"===b&&(I(1),c(x(),30,function(a){e(a)})),"1 day"===b&&(I(2),c(w(),null,function(a){g(A(a))})),"1 week"===b&&(I(3),c(v(),null,function(a){h(C(a))})),"1 month"===b&&(I(4),c(u(),null,function(a){f(B(a))})))},a.onHumidClick=function(b){a.humidview!==b&&(a.humidview=b,"1 hour"===b&&(J(1),d(x(),30,function(a){i(a)})),"1 day"===b&&(J(2),d(w(),null,function(a){k(A(a))})),"1 week"===b&&(J(3),d(v(),null,function(a){l(C(a))})),"1 month"===b&&(J(4),d(u(),null,function(a){j(B(a))})))}}]),angular.module("greenFrontApp").controller("HeaderCtrl",["$scope",function(a){a.update=function(a){for(var b=document.getElementById("choices").children,c=0;c<b.length;c++)b[c].className="";document.getElementById(a).className="active"}}]),angular.module("greenFrontApp").controller("NoiceCtrl",["$scope","$firebaseArray","$timeout",function(a,b,c){function d(a,b,d){y=null!==b?z.orderByChild("timestamp").startAt(a).limit(b):z.orderByChild("timestamp").startAt(a),y.on("value",function(a){c(function(){u(),d(a)})})}function e(a){var b=[],c=[];a.forEach(function(a){b.push(a.val().loudest),c.push(a.val().average),k(a)}),v(c,b)}function f(a){var b=[],c=[];a.forEach(function(a){var d=q(a);d.count>0&&(b.push(d.average),c.push(d.loudest),i(a[0]))}),v(b,c)}function g(a){var b=[],c=[];a.forEach(function(a){var d=q(a);d.count>0&&(b.push(d.average),c.push(d.loudest),j(a[0]))}),v(b,c)}function h(a){var b=[],c=[];a.forEach(function(a){a.forEach(function(a){var d=q(a);d.count>0&&(b.push(d.average),c.push(d.loudest),l(a[0]))})}),v(b,c)}function i(b){var c=new Date(b.val().timestamp);a.labels.push(w(c.getDate())+"."+w(c.getMonth())+".")}function j(b){var c=new Date(b.val().timestamp);a.labels.push(w(c.getHours())+":00")}function k(b){var c=new Date(b.val().timestamp);a.labels.push(w(c.getHours())+":"+w(c.getMinutes()))}function l(b){var c="",d=new Date(b.val().timestamp).getDay();c=0===d?"Sun. ":1===d?"Mon. ":2===d?"Tue. ":3===d?"Wed. ":4===d?"Thu. ":5===d?"Fri. ":"Sat. ",new Date(b.val().timestamp).getHours()<6?a.labels.push(c+"3am"):new Date(b.val().timestamp).getHours()>=6&&new Date(b.val().timestamp).getHours()<12?a.labels.push(c+"9am"):new Date(b.val().timestamp).getHours()>=12&&new Date(b.val().timestamp).getHours()<18?a.labels.push(c+"3pm"):a.labels.push(c+"9pm")}function m(){var a=new Date,b=25056e5;return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()-b}function n(){var a=new Date,b=5184e5;return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()-b}function o(){var a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()}function p(){var a=(new Date,36e5);return(new Date).getTime()-a}function q(a){var b=0,c=0,d=0;a.forEach(function(a){b+=parseFloat(a.val().average),d<parseInt(a.val().loudest)&&(d=parseInt(a.val().loudest)),c++});var e={average:(b/c).toFixed(2),loudest:d,count:c};return e}function r(a){for(var b=[],c=0;24>c;c++)b[c]=[];return a.forEach(function(a){b[new Date(a.val().timestamp).getHours()].push(a)}),b}function s(a){for(var b=[],c=0;30>c;c++)b[c]=[];var d=null,e=0;return a.forEach(function(a){null===d&&(d=new Date(a.val().timestamp).getDate()),d!==new Date(a.val().timestamp).getDate()&&(d=new Date(a.val().timestamp).getDate(),e++),b[e].push(a)}),b}function t(a){for(var b=[],c=0;7>c;c++){b[c]=[];for(var d=0;4>d;d++)b[c][d]=[]}var e=null,f=0;return a.forEach(function(a){null===e&&(e=new Date(a.val().timestamp).getDate()),e!==new Date(a.val().timestamp).getDate()&&(e=new Date(a.val().timestamp).getDate(),f++),new Date(a.val().timestamp).getHours()>=0&&new Date(a.val().timestamp).getHours()<6?b[f][0].push(a):new Date(a.val().timestamp).getHours()>=6&&new Date(a.val().timestamp).getHours()<12?b[f][1].push(a):new Date(a.val().timestamp).getHours()>=12&&new Date(a.val().timestamp).getHours()<18?b[f][2].push(a):b[f][3].push(a)}),b}function u(){a.data=[],a.labels=[]}function v(b,c){a.data.push(b),a.data.push(c)}function w(a){return 10>a?"0"+a:a}function x(b){1===b?(a.avgExpl="is the average noice calculated from the outputs of the 0.5 second loops over 2 minutes of time. For example 18:02 represents the time between 18:00:00 and 18:01:59.",a.peakExpl="is the highest single output received from the 0.5 second loops over the 2 minutes of time."):2===b?(a.avgExpl="is the average noice calculated from the outputs of the 0.5 second loops over 1 hour of time. For example 18:00 represents the time between 18:00 and 18:59.",a.peakExpl="is the highest single output received from the 0.5 second loops over the 1 hour of time."):3===b?(a.avgExpl="is the average noice calculated from the outputs of the 0.5 second loops over 6 hours of time. For example 3am represents the time between 00:00 and 06:00.",a.peakExpl="is the highest single output received from the 0.5 second loops over the 6 hours of time."):4===b&&(a.avgExpl="is the average noice calculated from the outputs of the 0.5 second loops over 1 day of time. For example 01.05. represents the time between 00:00 and 23:59 that same day.",a.peakExpl="is the highest single output received from the 0.5 second loops over the 1 day of time.")}var y,z=new Firebase("https://radiant-heat-5119.firebaseio.com/voices");a.view="1 hour",a.items=["1 hour","1 day","1 week","1 month"],a.series=["Average","Peak"],a.labels=[],a.data=[],a.avgExpl="",a.peakExpl="",x(1),d(p(),30,function(a){e(a)}),a.onClick=function(b){a.view!==b&&(a.view=b,"1 hour"===b&&(x(1),d(p(),30,function(a){e(a)})),"1 day"===b&&(x(2),d(o(),null,function(a){g(r(a))})),"1 week"===b&&(x(3),d(n(),null,function(a){h(t(a))})),"1 month"===b&&(x(4),d(m(),null,function(a){f(s(a))})))}}]),angular.module("greenFrontApp").controller("LightCtrl",["$scope",function(a){a.labels=["January","February","March","April","May","June","July","January","February","March","April","May","June","July"],a.series=["Series A","Series B"],a.data=[[200,259,280,281,256,255,240,200,259,280,281,256,255,240],[228,248,240,219,286,227,290,228,248,240,219,286,227,290]],a.onClick=function(a,b){console.log(a,b)}}]);